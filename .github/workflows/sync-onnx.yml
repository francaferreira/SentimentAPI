name: ðŸ”„ Sync ONNX Model

on:
  push:
    paths:
      - 'data-science/**.onnx' # SÃ³ dispara se mudar o arquivo ONNX na pasta de dados
    branches:
      - main 

jobs:
  sync-model:
    runs-on: ubuntu-latest
    permissions:
      contents: write # PermissÃ£o para o robÃ´ fazer o commit

    steps:
      # 1. Baixa todo o repositÃ³rio
      - name: ðŸ“¥ Checkout Code
        uses: actions/checkout@v4

      # 2. Copia o arquivo (Caminhos Ajustados)
      - name: ðŸ“‚ Copy ONNX to Java Resources
        run: |
          echo "Copiando modelo..."
          
          # Garante que a pasta de destino existe
          # Caminho: SentimentAPI/src/main/resources/
          mkdir -p src/main/resources/
          
          # Copia o arquivo da pasta de Data Science para o Resources
          # O comando 'cp' vai pegar o arquivo e jogar na pasta de destino
          cp data-science/sentiment_model_multilang.onnx src/main/resources/
          
          echo "âœ… CÃ³pia concluÃ­da!"

      # 3. Faz o Commit automÃ¡tico apenas se houve mudanÃ§a
      - name: ðŸ’¾ Commit Changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ðŸ¤– CI: Atualizando modelo ONNX no Resources (Auto-Sync)"
          # Avisa pro Git olhar especificamente para essa pasta
          file_pattern: 'src/main/resources/*.onnx'